(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[17],{"7MhO":function(e,n,t){e.exports=t.p+"static/fibertreecreate2-complete.1375a2fa.png"},"Pk/r":function(e,n,t){e.exports=t.p+"static/fibertreecreate1-progress.c1b57b3b.png"},WV2h:function(e,n,t){"use strict";t.r(n);var l=t("q1tI"),a=t.n(l),r=t("dEAq"),c=t("H1Ra"),o=a.a.memo((e=>{e.demos;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"markdown"},a.a.createElement("h1",{id:"fiber-\u6811\u6784\u9020\u57fa\u7840\u51c6\u5907"},a.a.createElement(r["AnchorLink"],{to:"#fiber-\u6811\u6784\u9020\u57fa\u7840\u51c6\u5907","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"fiber \u6811\u6784\u9020(\u57fa\u7840\u51c6\u5907)"),a.a.createElement("p",null,"\u5728 React \u8fd0\u884c\u65f6\u4e2d, ",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u4f4d\u4e8e",a.a.createElement("code",null,"react-reconciler"),"\u5305."),a.a.createElement("p",null,"\u5728\u6b63\u5f0f\u89e3\u8bfb",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u4e4b\u524d, \u518d\u6b21\u56de\u987e\u4e00\u4e0b",a.a.createElement(r["Link"],{to:"./reconciler-workflow"},"reconciler \u8fd0\u4f5c\u6d41\u7a0b"),"\u7684 4 \u4e2a\u9636\u6bb5:"),a.a.createElement("p",null,a.a.createElement("img",{src:t("wOdG"),alt:""})),a.a.createElement("ol",null,a.a.createElement("li",null,"\u8f93\u5165\u9636\u6bb5: \u8854\u63a5",a.a.createElement("code",null,"react-dom"),"\u5305, \u627f\u63a5",a.a.createElement("code",null,"fiber\u66f4\u65b0"),"\u8bf7\u6c42(\u53ef\u4ee5\u53c2\u8003",a.a.createElement(r["Link"],{to:"./bootstrap"},"React \u5e94\u7528\u7684\u542f\u52a8\u8fc7\u7a0b"),")."),a.a.createElement("li",null,"\u6ce8\u518c\u8c03\u5ea6\u4efb\u52a1: \u4e0e\u8c03\u5ea6\u4e2d\u5fc3(",a.a.createElement("code",null,"scheduler"),"\u5305)\u4ea4\u4e92, \u6ce8\u518c\u8c03\u5ea6\u4efb\u52a1",a.a.createElement("code",null,"task"),", \u7b49\u5f85\u4efb\u52a1\u56de\u8c03(\u53ef\u4ee5\u53c2\u8003",a.a.createElement(r["Link"],{to:"./scheduler"},"React \u8c03\u5ea6\u539f\u7406(scheduler)"),")."),a.a.createElement("li",null,"\u6267\u884c\u4efb\u52a1\u56de\u8c03: \u5728\u5185\u5b58\u4e2d\u6784\u9020\u51fa",a.a.createElement("code",null,"fiber\u6811"),"\u548c",a.a.createElement("code",null,"DOM"),"\u5bf9\u8c61, \u4e5f\u662f",a.a.createElement("strong",null,"fiber \u6811\u6784\u9020\u7684\u91cd\u70b9\u5185\u5bb9"),"."),a.a.createElement("li",null,"\u8f93\u51fa: \u4e0e\u6e32\u67d3\u5668(",a.a.createElement("code",null,"react-dom"),")\u4ea4\u4e92, \u6e32\u67d3",a.a.createElement("code",null,"DOM"),"\u8282\u70b9.")),a.a.createElement("p",null,a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u5904\u4e8e\u4e0a\u8ff0\u7b2c 3 \u4e2a\u9636\u6bb5, \u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u89c6\u89d2\u6765\u7406\u89e3",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u5728",a.a.createElement("code",null,"React"),"\u8fd0\u884c\u65f6\u4e2d\u6240\u5904\u7684\u4f4d\u7f6e:"),a.a.createElement("ul",null,a.a.createElement("li",null,"\u4ece",a.a.createElement("code",null,"scheduler"),"\u8c03\u5ea6\u4e2d\u5fc3\u7684\u89d2\u5ea6\u6765\u770b, \u5b83\u662f\u4efb\u52a1\u961f\u5217",a.a.createElement("code",null,"taskQueue"),"\u4e2d\u7684\u4e00\u4e2a\u5177\u4f53\u7684\u4efb\u52a1\u56de\u8c03(",a.a.createElement("code",null,"task.callback"),")."),a.a.createElement("li",null,"\u4ece",a.a.createElement(r["Link"],{to:"./workloop"},"React \u5de5\u4f5c\u5faa\u73af"),"\u7684\u89d2\u5ea6\u6765\u770b, \u5b83\u5c5e\u4e8e",a.a.createElement("code",null,"fiber\u6811\u6784\u9020\u5faa\u73af"),".")),a.a.createElement("p",null,"\u7531\u4e8e",a.a.createElement("code",null,"fiber \u6811\u6784\u9020"),"\u6e90\u7801\u91cf\u6bd4\u8f83\u5927, \u672c\u7cfb\u5217\u6839\u636e",a.a.createElement("code",null,"React"),"\u8fd0\u884c\u7684",a.a.createElement("code",null,"\u5185\u5b58\u72b6\u6001"),", \u5206\u4e3a 2 \u79cd\u60c5\u51b5\u6765\u8bf4\u660e:"),a.a.createElement("ol",null,a.a.createElement("li",null,"\u521d\u6b21\u521b\u5efa: \u5728",a.a.createElement("code",null,"React"),"\u5e94\u7528\u9996\u6b21\u542f\u52a8\u65f6, \u754c\u9762\u8fd8\u6ca1\u6709\u6e32\u67d3, \u6b64\u65f6\u5e76\u4e0d\u4f1a\u8fdb\u5165\u5bf9\u6bd4\u8fc7\u7a0b, \u76f8\u5f53\u4e8e\u76f4\u63a5\u6784\u9020\u4e00\u68f5\u5168\u65b0\u7684\u6811."),a.a.createElement("li",null,"\u5bf9\u6bd4\u66f4\u65b0: ",a.a.createElement("code",null,"React"),"\u5e94\u7528\u542f\u52a8\u540e, \u754c\u9762\u5df2\u7ecf\u6e32\u67d3. \u5982\u679c\u518d\u6b21\u53d1\u751f\u66f4\u65b0, \u521b\u5efa",a.a.createElement("code",null,"\u65b0fiber"),"\u4e4b\u524d\u9700\u8981\u548c",a.a.createElement("code",null,"\u65e7fiber"),"\u8fdb\u884c\u5bf9\u6bd4. \u6700\u540e\u6784\u9020\u7684 fiber \u6811\u6709\u53ef\u80fd\u662f\u5168\u65b0\u7684, \u4e5f\u53ef\u80fd\u662f\u90e8\u5206\u66f4\u65b0\u7684.")),a.a.createElement("p",null,"\u65e0\u8bba\u662f",a.a.createElement("code",null,"\u521d\u6b21\u521b\u5efa"),"\u8fd8\u662f",a.a.createElement("code",null,"\u5bf9\u6bd4\u66f4\u65b0"),", \u57fa\u7840\u6982\u5ff5\u90fd\u662f\u901a\u7528\u7684, \u672c\u8282\u5c06\u4ecb\u7ecd\u8fd9\u4e9b\u57fa\u7840\u77e5\u8bc6, \u4e3a\u6b63\u5f0f\u8fdb\u5165",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u505a\u51c6\u5907."),a.a.createElement("h2",{id:"reactelement-fiber-dom-\u4e09\u8005\u7684\u5173\u7cfb"},a.a.createElement(r["AnchorLink"],{to:"#reactelement-fiber-dom-\u4e09\u8005\u7684\u5173\u7cfb","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"ReactElement, Fiber, DOM \u4e09\u8005\u7684\u5173\u7cfb"),a.a.createElement("p",null,"\u5728",a.a.createElement(r["Link"],{to:"./object-structure"},"React \u5e94\u7528\u4e2d\u7684\u9ad8\u9891\u5bf9\u8c61"),"\u4e00\u6587\u4e2d, \u5df2\u7ecf\u4ecb\u7ecd\u4e86",a.a.createElement("code",null,"ReactElement"),"\u548c",a.a.createElement("code",null,"Fiber"),"\u5bf9\u8c61\u7684\u6570\u636e\u7ed3\u6784. \u8fd9\u91cc\u6211\u4eec\u68b3\u7406\u51fa",a.a.createElement("code",null,"ReactElement, Fiber, DOM"),"\u8fd9 3 \u79cd\u5bf9\u8c61\u7684\u5173\u7cfb"),a.a.createElement("ol",null,a.a.createElement("li",null,a.a.createElement("p",null,a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react/src/ReactElement.js#L126-L146"},"ReactElement \u5bf9\u8c61"),"(type \u5b9a\u4e49\u5728",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/shared/ReactElementType.js#L15"},"shared \u5305\u4e2d"),")"),a.a.createElement("ul",null,a.a.createElement("li",null,"\u6240\u6709\u91c7\u7528",a.a.createElement("code",null,"jsx"),"\u8bed\u6cd5\u4e66\u5199\u7684\u8282\u70b9, \u90fd\u4f1a\u88ab\u7f16\u8bd1\u5668\u8f6c\u6362, \u6700\u7ec8\u4f1a\u4ee5",a.a.createElement("code",null,"React.createElement(...)"),"\u7684\u65b9\u5f0f, \u521b\u5efa\u51fa\u6765\u4e00\u4e2a\u4e0e\u4e4b\u5bf9\u5e94\u7684",a.a.createElement("code",null,"ReactElement"),"\u5bf9\u8c61"))),a.a.createElement("li",null,a.a.createElement("p",null,a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiber.old.js#L116-L155"},"fiber \u5bf9\u8c61"),"(type \u7c7b\u578b\u7684\u5b9a\u4e49\u5728",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactInternalTypes.js#L47-L174"},"ReactInternalTypes.js"),"\u4e2d)"),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement("code",null,"fiber\u5bf9\u8c61"),"\u662f\u901a\u8fc7",a.a.createElement("code",null,"ReactElement"),"\u5bf9\u8c61\u8fdb\u884c\u521b\u5efa\u7684, \u591a\u4e2a",a.a.createElement("code",null,"fiber\u5bf9\u8c61"),"\u6784\u6210\u4e86\u4e00\u68f5",a.a.createElement("code",null,"fiber\u6811"),", ",a.a.createElement("code",null,"fiber\u6811"),"\u662f\u6784\u9020",a.a.createElement("code",null,"DOM\u6811"),"\u7684\u6570\u636e\u6a21\u578b, ",a.a.createElement("code",null,"fiber\u6811"),"\u7684\u4efb\u4f55\u6539\u52a8, \u6700\u540e\u90fd\u4f53\u73b0\u5230",a.a.createElement("code",null,"DOM\u6811"),"."))),a.a.createElement("li",null,a.a.createElement("p",null,a.a.createElement(r["Link"],{to:"https://developer.mozilla.org/zh-CN/docs/Web/API/Document_Object_Model"},"DOM \u5bf9\u8c61"),": \u6587\u6863\u5bf9\u8c61\u6a21\u578b"),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement("code",null,"DOM"),"\u5c06\u6587\u6863\u89e3\u6790\u4e3a\u4e00\u4e2a\u7531\u8282\u70b9\u548c\u5bf9\u8c61\uff08\u5305\u542b\u5c5e\u6027\u548c\u65b9\u6cd5\u7684\u5bf9\u8c61\uff09\u7ec4\u6210\u7684\u7ed3\u6784\u96c6\u5408, \u4e5f\u5c31\u662f\u5e38\u8bf4\u7684",a.a.createElement("code",null,"DOM\u6811"),"."),a.a.createElement("li",null,a.a.createElement("code",null,"JavaScript"),"\u53ef\u4ee5\u8bbf\u95ee\u548c\u64cd\u4f5c\u5b58\u50a8\u5728 DOM \u4e2d\u7684\u5185\u5bb9, \u4e5f\u5c31\u662f\u64cd\u4f5c",a.a.createElement("code",null,"DOM\u5bf9\u8c61"),", \u8fdb\u800c\u89e6\u53d1 UI \u6e32\u67d3.")))),a.a.createElement("p",null,"\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u53cd\u6620\u4e86\u6211\u4eec\u4e66\u5199\u7684 JSX \u4ee3\u7801\u5230 DOM \u8282\u70b9\u7684\u8f6c\u6362\u8fc7\u7a0b:"),a.a.createElement("p",null,a.a.createElement("img",{src:t("xeiz"),alt:""})),a.a.createElement("p",null,"\u6ce8\u610f:"),a.a.createElement("ul",null,a.a.createElement("li",null,"\u5f00\u53d1\u4eba\u5458\u80fd\u591f\u63a7\u5236\u7684\u662f",a.a.createElement("code",null,"JSX"),", \u4e5f\u5c31\u662f",a.a.createElement("code",null,"ReactElement"),"\u5bf9\u8c61."),a.a.createElement("li",null,a.a.createElement("code",null,"fiber\u6811"),"\u662f\u901a\u8fc7",a.a.createElement("code",null,"ReactElement"),"\u751f\u6210\u7684, \u5982\u679c\u8131\u79bb\u4e86",a.a.createElement("code",null,"ReactElement"),",",a.a.createElement("code",null,"fiber\u6811"),"\u4e5f\u65e0\u4ece\u8c08\u8d77. \u6240\u4ee5\u662f",a.a.createElement("code",null,"ReactElement"),"\u6811(\u4e0d\u662f\u4e25\u683c\u7684\u6811\u7ed3\u6784, \u4e3a\u4e86\u65b9\u4fbf\u4e5f\u79f0\u4e3a\u6811)\u9a71\u52a8",a.a.createElement("code",null,"fiber\u6811"),"."),a.a.createElement("li",null,a.a.createElement("code",null,"fiber\u6811"),"\u662f",a.a.createElement("code",null,"DOM\u6811"),"\u7684\u6570\u636e\u6a21\u578b, ",a.a.createElement("code",null,"fiber\u6811"),"\u9a71\u52a8",a.a.createElement("code",null,"DOM\u6811"))),a.a.createElement("p",null,"\u5f00\u53d1\u4eba\u5458\u901a\u8fc7\u7f16\u7a0b\u53ea\u80fd\u63a7\u5236",a.a.createElement("code",null,"ReactElement"),"\u6811\u7684\u7ed3\u6784, ",a.a.createElement("code",null,"ReactElement\u6811"),"\u9a71\u52a8",a.a.createElement("code",null,"fiber\u6811"),", ",a.a.createElement("code",null,"fiber\u6811"),"\u518d\u9a71\u52a8",a.a.createElement("code",null,"DOM\u6811"),", \u6700\u540e\u5c55\u73b0\u5230\u9875\u9762\u4e0a. \u6240\u4ee5",a.a.createElement("code",null,"fiber\u6811"),"\u7684\u6784\u9020\u8fc7\u7a0b, \u5b9e\u9645\u4e0a\u5c31\u662f",a.a.createElement("code",null,"ReactElement"),"\u5bf9\u8c61\u5230",a.a.createElement("code",null,"fiber"),"\u5bf9\u8c61\u7684\u8f6c\u6362\u8fc7\u7a0b."),a.a.createElement("h2",{id:"\u5168\u5c40\u53d8\u91cf"},a.a.createElement(r["AnchorLink"],{to:"#\u5168\u5c40\u53d8\u91cf","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u5168\u5c40\u53d8\u91cf"),a.a.createElement("p",null,"\u4ece",a.a.createElement(r["Link"],{to:"./workloop"},"React \u5de5\u4f5c\u5faa\u73af"),"\u7684\u89d2\u5ea6\u6765\u770b, \u6574\u4e2a\u6784\u9020\u8fc7\u7a0b\u88ab\u5305\u88f9\u5728",a.a.createElement("code",null,"fiber\u6811\u6784\u9020\u5faa\u73af"),"\u4e2d(\u5bf9\u5e94\u6e90\u7801\u4f4d\u4e8e",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js"},"ReactFiberWorkLoop.js"),")."),a.a.createElement("p",null,"\u5728",a.a.createElement("code",null,"React"),"\u8fd0\u884c\u65f6, ",a.a.createElement("code",null,"ReactFiberWorkLoop.js"),"\u95ed\u5305\u4e2d\u7684",a.a.createElement("code",null,"\u5168\u5c40\u53d8\u91cf"),"\u4f1a\u968f\u7740",a.a.createElement("code",null,"fiber\u6811\u6784\u9020\u5faa\u73af"),"\u7684\u8fdb\u884c\u800c\u53d8\u5316, \u73b0\u5728\u67e5\u770b\u5176\u4e2d\u91cd\u8981\u7684\u5168\u5c40\u53d8\u91cf(",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L247-L367"},"\u6e90\u7801\u94fe\u63a5"),"):"),a.a.createElement(c["a"],{code:"// \u5f53\u524dReact\u7684\u6267\u884c\u6808(\u6267\u884c\u4e0a\u4e0b\u6587)\nlet executionContext: ExecutionContext = NoContext;\n\n// \u5f53\u524droot\u8282\u70b9\nlet workInProgressRoot: FiberRoot | null = null;\n// \u6b63\u5728\u5904\u7406\u4e2d\u7684fiber\u8282\u70b9\nlet workInProgress: Fiber | null = null;\n// \u6b63\u5728\u6e32\u67d3\u7684\u8f66\u9053(\u590d\u6570)\nlet workInProgressRootRenderLanes: Lanes = NoLanes;\n\n// \u5305\u542b\u6240\u6709\u5b50\u8282\u70b9\u7684\u4f18\u5148\u7ea7, \u662fworkInProgressRootRenderLanes\u7684\u8d85\u96c6\n// \u5927\u591a\u6570\u60c5\u51b5\u4e0b: \u5728\u5de5\u4f5c\u5faa\u73af\u6574\u4f53\u5c42\u9762\u4f1a\u4f7f\u7528workInProgressRootRenderLanes, \u5728begin/complete\u9636\u6bb5\u5c42\u9762\u4f1a\u4f7f\u7528 subtreeRenderLanes\nlet subtreeRenderLanes: Lanes = NoLanes;\n// \u4e00\u4e2a\u6808\u7ed3\u6784: \u4e13\u95e8\u5b58\u50a8\u5f53\u524d\u8282\u70b9\u7684 subtreeRenderLanes\nconst subtreeRenderLanesCursor: StackCursor<Lanes> = createCursor(NoLanes);\n\n// fiber\u6784\u9020\u5b8c\u540e, root\u8282\u70b9\u7684\u72b6\u6001: completed, errored, suspended\u7b49\nlet workInProgressRootExitStatus: RootExitStatus = RootIncomplete;\n// \u91cd\u5927\u9519\u8bef\nlet workInProgressRootFatalError: mixed = null;\n// \u6574\u4e2arender\u671f\u95f4\u6240\u4f7f\u7528\u5230\u7684\u6240\u6709lanes\nlet workInProgressRootIncludedLanes: Lanes = NoLanes;\n// \u5728render\u671f\u95f4\u88ab\u8df3\u8fc7(\u7531\u4e8e\u4f18\u5148\u7ea7\u4e0d\u591f)\u7684lanes: \u53ea\u5305\u62ec\u672a\u5904\u7406\u7684updates, \u4e0d\u5305\u62ec\u88ab\u590d\u7528\u7684fiber\u8282\u70b9\nlet workInProgressRootSkippedLanes: Lanes = NoLanes;\n// \u5728render\u671f\u95f4\u88ab\u4fee\u6539\u8fc7\u7684lanes\nlet workInProgressRootUpdatedLanes: Lanes = NoLanes;\n\n// \u9632\u6b62\u65e0\u9650\u5faa\u73af\u548c\u5d4c\u5957\u66f4\u65b0\nconst NESTED_UPDATE_LIMIT = 50;\nlet nestedUpdateCount: number = 0;\nlet rootWithNestedUpdates: FiberRoot | null = null;\n\nconst NESTED_PASSIVE_UPDATE_LIMIT = 50;\nlet nestedPassiveUpdateCount: number = 0;\n\n// \u53d1\u8d77\u66f4\u65b0\u7684\u65f6\u95f4\nlet currentEventTime: number = NoTimestamp;\nlet currentEventWipLanes: Lanes = NoLanes;\nlet currentEventPendingLanes: Lanes = NoLanes;",lang:"js"}),a.a.createElement("p",null,"\u5728\u6e90\u7801\u4e2d, \u5927\u90e8\u5206\u53d8\u91cf\u90fd\u5e26\u6709\u82f1\u6587\u6ce8\u91ca(\u8bfb\u8005\u53ef\u81ea\u884c\u67e5\u9605), \u6b64\u5904\u53ea\u5217\u4e3e\u4e86",a.a.createElement("code",null,"fiber\u6811\u6784\u9020\u5faa\u73af"),"\u4e2d\u6700\u6838\u5fc3\u7684\u53d8\u91cf"),a.a.createElement("h3",{id:"\u6267\u884c\u4e0a\u4e0b\u6587"},a.a.createElement(r["AnchorLink"],{to:"#\u6267\u884c\u4e0a\u4e0b\u6587","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u6267\u884c\u4e0a\u4e0b\u6587"),a.a.createElement("p",null,"\u5728\u5168\u5c40\u53d8\u91cf\u4e2d\u6709",a.a.createElement("code",null,"executionContext"),", \u4ee3\u8868",a.a.createElement("code",null,"\u6e32\u67d3\u671f\u95f4"),"\u7684",a.a.createElement("code",null,"\u6267\u884c\u6808"),"(\u6216\u53eb\u505a",a.a.createElement("code",null,"\u6267\u884c\u4e0a\u4e0b\u6587"),"), \u5b83\u4e5f\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u8868\u793a\u7684\u53d8\u91cf, \u901a\u8fc7\u4f4d\u8fd0\u7b97\u8fdb\u884c\u64cd\u4f5c(\u53c2\u8003",a.a.createElement(r["Link"],{to:"../algorithm/bitfield"},"React \u7b97\u6cd5\u4e4b\u4f4d\u8fd0\u7b97"),"). \u5728\u6e90\u7801\u4e2d\u4e00\u5171\u5b9a\u4e49\u4e86 8 \u79cd\u6267\u884c\u6808:"),a.a.createElement(c["a"],{code:"type ExecutionContext = number;\nexport const NoContext = /*             */ 0b0000000;\nconst BatchedContext = /*               */ 0b0000001;\nconst EventContext = /*                 */ 0b0000010;\nconst DiscreteEventContext = /*         */ 0b0000100;\nconst LegacyUnbatchedContext = /*       */ 0b0001000;\nconst RenderContext = /*                */ 0b0010000;\nconst CommitContext = /*                */ 0b0100000;",lang:"js"}),a.a.createElement("p",null,"\u4e0a\u6587\u56de\u987e\u4e86",a.a.createElement("code",null,"reconciler \u8fd0\u4f5c\u6d41\u7a0b"),"\u7684 4 \u4e2a\u9636\u6bb5, \u8fd9 4 \u4e2a\u9636\u6bb5\u53ea\u662f\u4e00\u4e2a\u6574\u4f53\u5212\u5206. \u5982\u679c\u5177\u4f53\u5230\u6bcf\u4e00\u6b21\u66f4\u65b0, \u662f\u6709\u5dee\u5f02\u7684. \u6bd4\u5982\u8bf4: ",a.a.createElement("code",null,"Legacy"),"\u6a21\u5f0f\u4e0b\u7684\u9996\u6b21\u66f4\u65b0, \u4e0d\u4f1a\u7ecf\u8fc7",a.a.createElement("code",null,"\u8c03\u5ea6\u4e2d\u5fc3"),"(\u7b2c 2 \u9636\u6bb5),\u800c\u662f\u76f4\u63a5\u8fdb\u5165",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"(\u7b2c 3 \u9636\u6bb5)."),a.a.createElement("p",null,"\u4e8b\u5b9e\u4e0a\u6b63\u662f",a.a.createElement("code",null,"executionContext"),"\u5728\u64cd\u63a7",a.a.createElement("code",null,"reconciler \u8fd0\u4f5c\u6d41\u7a0b"),"(\u6e90\u7801\u4f53\u73b0\u5728",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L517-L619"},"scheduleUpdateOnFiber \u51fd\u6570"),")."),a.a.createElement(c["a"],{code:"export function scheduleUpdateOnFiber(\n  fiber: Fiber,\n  lane: Lane,\n  eventTime: number,\n) {\n  if (lane === SyncLane) {\n    // legacy\u6216blocking\u6a21\u5f0f\n    if (\n      (executionContext & LegacyUnbatchedContext) !== NoContext &&\n      (executionContext & (RenderContext | CommitContext)) === NoContext\n    ) {\n      performSyncWorkOnRoot(root);\n    } else {\n      // \u540e\u7eed\u7684\u66f4\u65b0\n      // \u8fdb\u5165\u7b2c2\u9636\u6bb5, \u6ce8\u518c\u8c03\u5ea6\u4efb\u52a1\n      ensureRootIsScheduled(root, eventTime);\n      if (executionContext === NoContext) {\n        // \u5982\u679c\u6267\u884c\u4e0a\u4e0b\u6587\u4e3a\u7a7a, \u4f1a\u53d6\u6d88\u8c03\u5ea6\u4efb\u52a1, \u624b\u52a8\u6267\u884c\u56de\u8c03\n        // \u8fdb\u5165\u7b2c3\u9636\u6bb5, \u8fdb\u884cfiber\u6811\u6784\u9020\n        flushSyncCallbackQueue();\n      }\n    }\n  } else {\n    // concurrent\u6a21\u5f0f\n    // \u65e0\u8bba\u662f\u5426\u521d\u6b21\u66f4\u65b0, \u90fd\u6b63\u5e38\u8fdb\u5165\u7b2c2\u9636\u6bb5, \u6ce8\u518c\u8c03\u5ea6\u4efb\u52a1\n    ensureRootIsScheduled(root, eventTime);\n  }\n}",lang:"js"}),a.a.createElement("p",null,"\u5728 render \u8fc7\u7a0b\u4e2d, \u6bcf\u4e00\u4e2a\u9636\u6bb5\u90fd\u4f1a\u6539\u53d8",a.a.createElement("code",null,"executionContext"),"(render \u4e4b\u524d, \u4f1a\u8bbe\u7f6e",a.a.createElement("code",null,"executionContext |= RenderContext"),"; commit \u4e4b\u524d, \u4f1a\u8bbe\u7f6e",a.a.createElement("code",null,"executionContext |= CommitContext"),"), \u5047\u8bbe\u5728",a.a.createElement("code",null,"render"),"\u8fc7\u7a0b\u4e2d\u518d\u6b21\u53d1\u8d77\u66f4\u65b0(\u5982\u5728",a.a.createElement("code",null,"UNSAFE_componentWillReceiveProps"),"\u751f\u547d\u5468\u671f\u4e2d\u8c03\u7528",a.a.createElement("code",null,"setState"),")\u5219\u53ef\u901a\u8fc7",a.a.createElement("code",null,"executionContext"),"\u6765\u5224\u65ad\u5f53\u524d\u7684",a.a.createElement("code",null,"render"),"\u72b6\u6001."),a.a.createElement("h3",{id:"\u53cc\u7f13\u51b2\u6280\u672fdouble-buffering"},a.a.createElement(r["AnchorLink"],{to:"#\u53cc\u7f13\u51b2\u6280\u672fdouble-buffering","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u53cc\u7f13\u51b2\u6280\u672f(double buffering)"),a.a.createElement("p",null,"\u5728\u5168\u5c40\u53d8\u91cf\u4e2d\u6709",a.a.createElement("code",null,"workInProgress"),", \u8fd8\u6709\u4e0d\u5c11\u4ee5",a.a.createElement("code",null,"workInProgress"),"\u6765\u547d\u540d\u7684\u53d8\u91cf. ",a.a.createElement("code",null,"workInProgress"),"\u7684\u5e94\u7528\u5b9e\u9645\u4e0a\u5c31\u662f",a.a.createElement("code",null,"React"),"\u7684\u53cc\u7f13\u51b2\u6280\u672f(",a.a.createElement("code",null,"double buffering"),")."),a.a.createElement("p",null,"\u5728\u4e0a\u6587\u6211\u4eec\u68b3\u7406\u4e86",a.a.createElement("code",null,"ReactElement, Fiber, DOM\u4e09\u8005\u7684\u5173\u7cfb"),", ",a.a.createElement("code",null,"fiber\u6811"),"\u7684\u6784\u9020\u8fc7\u7a0b, \u5c31\u662f\u628a",a.a.createElement("code",null,"ReactElement"),"\u8f6c\u6362\u6210",a.a.createElement("code",null,"fiber\u6811"),"\u7684\u8fc7\u7a0b. \u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d, \u5185\u5b58\u91cc\u4f1a\u540c\u65f6\u5b58\u5728 2 \u68f5",a.a.createElement("code",null,"fiber\u6811"),":"),a.a.createElement("ul",null,a.a.createElement("li",null,"\u5176\u4e00: \u4ee3\u8868\u5f53\u524d\u754c\u9762\u7684",a.a.createElement("code",null,"fiber"),"\u6811(\u5df2\u7ecf\u88ab\u5c55\u793a\u51fa\u6765, \u6302\u8f7d\u5230",a.a.createElement("code",null,"fiberRoot.current"),"\u4e0a). \u5982\u679c\u662f\u521d\u6b21\u6784\u9020(",a.a.createElement("code",null,"\u521d\u59cb\u5316\u6e32\u67d3"),"), \u9875\u9762\u8fd8\u6ca1\u6709\u6e32\u67d3, \u6b64\u65f6\u754c\u9762\u5bf9\u5e94\u7684 fiber \u6811\u4e3a\u7a7a(",a.a.createElement("code",null,"fiberRoot.current = null"),")."),a.a.createElement("li",null,"\u5176\u4e8c: \u6b63\u5728\u6784\u9020\u7684",a.a.createElement("code",null,"fiber"),"\u6811(\u5373\u5c06\u5c55\u793a\u51fa\u6765, \u6302\u8f7d\u5230",a.a.createElement("code",null,"HostRootFiber.alternate"),"\u4e0a, \u6b63\u5728\u6784\u9020\u7684\u8282\u70b9\u79f0\u4e3a",a.a.createElement("code",null,"workInProgress"),"). \u5f53\u6784\u9020\u5b8c\u6210\u4e4b\u540e, \u91cd\u65b0\u6e32\u67d3\u9875\u9762, \u6700\u540e\u5207\u6362",a.a.createElement("code",null,"fiberRoot.current = workInProgress"),", \u4f7f\u5f97",a.a.createElement("code",null,"fiberRoot.current"),"\u91cd\u65b0\u6307\u5411\u4ee3\u8868\u5f53\u524d\u754c\u9762\u7684",a.a.createElement("code",null,"fiber"),"\u6811.")),a.a.createElement("p",null,"\u6b64\u5904\u6d89\u53ca\u5230 2 \u4e2a\u5168\u5c40\u5bf9\u8c61",a.a.createElement("code",null,"fiberRoot"),"\u548c",a.a.createElement("code",null,"HostRootFiber"),", \u5728",a.a.createElement(r["Link"],{to:"./bootstrap"},"React \u5e94\u7528\u7684\u542f\u52a8\u8fc7\u7a0b"),"\u4e2d\u6709\u8be6\u7ec6\u7684\u8bf4\u660e."),a.a.createElement("p",null,"\u7528\u56fe\u6765\u8868\u8ff0",a.a.createElement("code",null,"double buffering"),"\u7684\u6982\u5ff5\u5982\u4e0b:"),a.a.createElement("ol",null,a.a.createElement("li",null,"\u6784\u9020\u8fc7\u7a0b\u4e2d, ",a.a.createElement("code",null,"fiberRoot.current"),"\u6307\u5411\u5f53\u524d\u754c\u9762\u5bf9\u5e94\u7684",a.a.createElement("code",null,"fiber"),"\u6811.")),a.a.createElement("p",null,a.a.createElement("img",{src:t("Pk/r"),alt:""})),a.a.createElement("ol",{start:2},a.a.createElement("li",null,"\u6784\u9020\u5b8c\u6210\u5e76\u6e32\u67d3, \u5207\u6362",a.a.createElement("code",null,"fiberRoot.current"),"\u6307\u9488, \u4f7f\u5176\u7ee7\u7eed\u6307\u5411\u5f53\u524d\u754c\u9762\u5bf9\u5e94\u7684",a.a.createElement("code",null,"fiber"),"\u6811(\u539f\u6765\u4ee3\u8868\u754c\u9762\u7684 fiber \u6811, \u53d8\u6210\u4e86\u5185\u5b58\u4e2d).")),a.a.createElement("p",null,a.a.createElement("img",{src:t("7MhO"),alt:""})),a.a.createElement("h3",{id:"\u4f18\u5148\u7ea7-lanes"},a.a.createElement(r["AnchorLink"],{to:"#\u4f18\u5148\u7ea7-lanes","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u4f18\u5148\u7ea7 ","{","#lanes","}"),a.a.createElement("p",null,"\u5728\u5168\u5c40\u53d8\u91cf\u4e2d\u6709\u4e0d\u5c11\u53d8\u91cf\u90fd\u4ee5 Lanes \u547d\u540d(\u5982",a.a.createElement("code",null,"workInProgressRootRenderLanes"),",",a.a.createElement("code",null,"subtreeRenderLanes"),"\u5176\u4f5c\u7528\u89c1\u4e0a\u6587\u6ce8\u91ca), \u5b83\u4eec\u90fd\u4e0e\u4f18\u5148\u7ea7\u76f8\u5173."),a.a.createElement("p",null,"\u5728\u524d\u6587",a.a.createElement(r["Link"],{to:"./priority"},"React \u4e2d\u7684\u4f18\u5148\u7ea7\u7ba1\u7406"),"\u4e2d, \u6211\u4eec\u4ecb\u7ecd\u4e86",a.a.createElement("code",null,"React"),"\u4e2d\u6709 3 \u5957\u4f18\u5148\u7ea7\u4f53\u7cfb, \u5e76\u4e86\u89e3\u4e86\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u8054. \u73b0\u5728",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u8fc7\u7a0b\u4e2d, \u5c06\u8981\u6df1\u5165\u5206\u6790\u8f66\u9053\u6a21\u578b",a.a.createElement("code",null,"Lane"),"\u7684\u5177\u4f53\u5e94\u7528."),a.a.createElement("p",null,"\u5728\u6574\u4e2a",a.a.createElement("code",null,"react-reconciler"),"\u5305\u4e2d, ",a.a.createElement("code",null,"Lane"),"\u7684\u5e94\u7528\u53ef\u4ee5\u5206\u4e3a 3 \u4e2a\u65b9\u9762:"),a.a.createElement("h4",{id:"update\u4f18\u5148\u7ea7updatelane-update-lane"},a.a.createElement(r["AnchorLink"],{to:"#update\u4f18\u5148\u7ea7updatelane-update-lane","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),a.a.createElement("code",null,"update"),"\u4f18\u5148\u7ea7(update.lane) ","{","#update-lane","}"),a.a.createElement("p",null,"\u5728",a.a.createElement(r["AnchorLink"],{to:"./object-structure#Update"},"React \u5e94\u7528\u4e2d\u7684\u9ad8\u9891\u5bf9\u8c61"),"\u4e00\u6587\u4e2d, \u4ecb\u7ecd\u8fc7",a.a.createElement("code",null,"update"),"\u5bf9\u8c61, \u5b83\u662f\u4e00\u4e2a\u73af\u5f62\u94fe\u8868. \u5bf9\u4e8e\u5355\u4e2a",a.a.createElement("code",null,"update"),"\u5bf9\u8c61\u6765\u8bb2, ",a.a.createElement("code",null,"update.lane"),"\u4ee3\u8868\u5b83\u7684\u4f18\u5148\u7ea7, \u79f0\u4e4b\u4e3a",a.a.createElement("code",null,"update"),"\u4f18\u5148\u7ea7."),a.a.createElement("p",null,"\u89c2\u5bdf\u5176\u6784\u9020\u51fd\u6570(",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactUpdateQueue.old.js#L152-L163"},"\u6e90\u7801\u94fe\u63a5"),"),\u5176\u4f18\u5148\u7ea7\u662f\u7531\u5916\u754c\u4f20\u5165."),a.a.createElement(c["a"],{code:"export function createUpdate(eventTime: number, lane: Lane): Update<*> {\n  const update: Update<*> = {\n    eventTime,\n    lane,\n    tag: UpdateState,\n    payload: null,\n    callback: null,\n    next: null,\n  };\n  return update;\n}",lang:"js"}),a.a.createElement("p",null,"\u5728",a.a.createElement("code",null,"React"),"\u4f53\u7cfb\u4e2d, \u6709 2 \u79cd\u60c5\u51b5\u4f1a\u521b\u5efa",a.a.createElement("code",null,"update"),"\u5bf9\u8c61:"),a.a.createElement("ol",null,a.a.createElement("li",null,"\u5e94\u7528\u521d\u59cb\u5316: \u5728",a.a.createElement("code",null,"react-reconciler"),"\u5305\u4e2d\u7684",a.a.createElement("code",null,"updateContainer"),"\u51fd\u6570\u4e2d(",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberReconciler.old.js#L250-L321"},"\u6e90\u7801"),")",a.a.createElement(c["a"],{code:"export function updateContainer(\n  element: ReactNodeList,\n  container: OpaqueRoot,\n  parentComponent: ?React$Component<any, any>,\n  callback: ?Function,\n): Lane {\n  const current = container.current;\n  const eventTime = requestEventTime();\n  const lane = requestUpdateLane(current); // \u6839\u636e\u5f53\u524d\u65f6\u95f4, \u521b\u5efa\u4e00\u4e2aupdate\u4f18\u5148\u7ea7\n  const update = createUpdate(eventTime, lane); // lane\u88ab\u7528\u4e8e\u521b\u5efaupdate\u5bf9\u8c61\n  update.payload = { element };\n  enqueueUpdate(current, update);\n  scheduleUpdateOnFiber(current, lane, eventTime);\n  return lane;\n}",lang:"js"})),a.a.createElement("li",null,"\u53d1\u8d77\u7ec4\u4ef6\u66f4\u65b0: \u5047\u8bbe\u5728 class \u7ec4\u4ef6\u4e2d\u8c03\u7528",a.a.createElement("code",null,"setState"),"(",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberClassComponent.old.js#L193-L288"},"\u6e90\u7801"),")")),a.a.createElement(c["a"],{code:"const classComponentUpdater = {\n  isMounted,\n  enqueueSetState(inst, payload, callback) {\n    const fiber = getInstance(inst);\n    const eventTime = requestEventTime(); // \u6839\u636e\u5f53\u524d\u65f6\u95f4, \u521b\u5efa\u4e00\u4e2aupdate\u4f18\u5148\u7ea7\n    const lane = requestUpdateLane(fiber); // lane\u88ab\u7528\u4e8e\u521b\u5efaupdate\u5bf9\u8c61\n    const update = createUpdate(eventTime, lane);\n    update.payload = payload;\n    enqueueUpdate(fiber, update);\n    scheduleUpdateOnFiber(fiber, lane, eventTime);\n  },\n};",lang:"js"}),a.a.createElement("p",null,"\u53ef\u4ee5\u770b\u5230, \u65e0\u8bba\u662f",a.a.createElement("code",null,"\u5e94\u7528\u521d\u59cb\u5316"),"\u6216\u8005",a.a.createElement("code",null,"\u53d1\u8d77\u7ec4\u4ef6\u66f4\u65b0"),", \u521b\u5efa",a.a.createElement("code",null,"update.lane"),"\u7684\u903b\u8f91\u90fd\u662f\u4e00\u6837\u7684, \u90fd\u662f\u6839\u636e\u5f53\u524d\u65f6\u95f4, \u521b\u5efa\u4e00\u4e2a update \u4f18\u5148\u7ea7."),a.a.createElement("p",null,a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L392-L493"},"requestUpdateLane"),":"),a.a.createElement(c["a"],{code:"export function requestUpdateLane(fiber: Fiber): Lane {\n  // Special cases\n  const mode = fiber.mode;\n  if ((mode & BlockingMode) === NoMode) {\n    // legacy \u6a21\u5f0f\n    return (SyncLane: Lane);\n  } else if ((mode & ConcurrentMode) === NoMode) {\n    // blocking\u6a21\u5f0f\n    return getCurrentPriorityLevel() === ImmediateSchedulerPriority\n      ? (SyncLane: Lane)\n      : (SyncBatchedLane: Lane);\n  }\n  // concurrent\u6a21\u5f0f\n  if (currentEventWipLanes === NoLanes) {\n    currentEventWipLanes = workInProgressRootIncludedLanes;\n  }\n  const isTransition = requestCurrentTransition() !== NoTransition;\n  if (isTransition) {\n    // \u7279\u6b8a\u60c5\u51b5, \u5904\u4e8esuspense\u8fc7\u7a0b\u4e2d\n    if (currentEventPendingLanes !== NoLanes) {\n      currentEventPendingLanes =\n        mostRecentlyUpdatedRoot !== null\n          ? mostRecentlyUpdatedRoot.pendingLanes\n          : NoLanes;\n    }\n    return findTransitionLane(currentEventWipLanes, currentEventPendingLanes);\n  }\n  // \u6b63\u5e38\u60c5\u51b5, \u83b7\u53d6\u8c03\u5ea6\u4f18\u5148\u7ea7\n  const schedulerPriority = getCurrentPriorityLevel();\n  let lane;\n  if (\n    (executionContext & DiscreteEventContext) !== NoContext &&\n    schedulerPriority === UserBlockingSchedulerPriority\n  ) {\n    // executionContext \u5b58\u5728\u8f93\u5165\u4e8b\u4ef6. \u4e14\u8c03\u5ea6\u4f18\u5148\u7ea7\u662f\u7528\u6237\u963b\u585e\u6027\u8d28\n    lane = findUpdateLane(InputDiscreteLanePriority, currentEventWipLanes);\n  } else {\n    // \u8c03\u5ea6\u4f18\u5148\u7ea7\u8f6c\u6362\u4e3a\u8f66\u9053\u6a21\u578b\n    const schedulerLanePriority = schedulerPriorityToLanePriority(\n      schedulerPriority,\n    );\n    lane = findUpdateLane(schedulerLanePriority, currentEventWipLanes);\n  }\n  return lane;\n}",lang:"js"}),a.a.createElement("p",null,"\u53ef\u4ee5\u770b\u5230",a.a.createElement("code",null,"requestUpdateLane"),"\u7684\u4f5c\u7528\u662f\u8fd4\u56de\u4e00\u4e2a\u5408\u9002\u7684 update \u4f18\u5148\u7ea7."),a.a.createElement("ol",null,a.a.createElement("li",null,"legacy \u6a21\u5f0f: \u8fd4\u56de",a.a.createElement("code",null,"SyncLane")),a.a.createElement("li",null,"blocking \u6a21\u5f0f: \u8fd4\u56de",a.a.createElement("code",null,"SyncLane")),a.a.createElement("li",null,"concurrent \u6a21\u5f0f:",a.a.createElement("ul",null,a.a.createElement("li",null,"\u6b63\u5e38\u60c5\u51b5\u4e0b, \u6839\u636e\u5f53\u524d\u7684",a.a.createElement("code",null,"\u8c03\u5ea6\u4f18\u5148\u7ea7"),"\u6765\u751f\u6210\u4e00\u4e2a",a.a.createElement("code",null,"lane"),"."),a.a.createElement("li",null,"\u7279\u6b8a\u60c5\u51b5\u4e0b(\u5904\u4e8e suspense \u8fc7\u7a0b\u4e2d), \u4f1a\u4f18\u5148\u9009\u62e9",a.a.createElement("code",null,"TransitionLanes"),"\u901a\u9053\u4e2d\u7684\u7a7a\u95f2\u901a\u9053(\u5982\u679c\u6240\u6709",a.a.createElement("code",null,"TransitionLanes"),"\u901a\u9053\u90fd\u88ab\u5360\u7528, \u5c31\u53d6\u6700\u9ad8\u4f18\u5148\u7ea7. ",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberLane.js#L548-L563"},"\u6e90\u7801"),").")))),a.a.createElement("p",null,"\u6700\u540e\u901a\u8fc7",a.a.createElement("code",null,"scheduleUpdateOnFiber(current, lane, eventTime);"),"\u51fd\u6570, \u628a",a.a.createElement("code",null,"update.lane"),"\u6b63\u5f0f\u5e26\u5165\u5230\u4e86",a.a.createElement("code",null,"\u8f93\u5165"),"\u9636\u6bb5."),a.a.createElement("p",null,a.a.createElement("code",null,"scheduleUpdateOnFiber"),"\u662f",a.a.createElement("code",null,"\u8f93\u5165"),"\u9636\u6bb5\u7684\u5fc5\u7ecf\u51fd\u6570, \u5728\u672c\u7cfb\u5217\u7684\u6587\u7ae0\u4e2d\u5df2\u7ecf\u591a\u6b21\u63d0\u5230, \u6b64\u5904\u4ee5",a.a.createElement("code",null,"update.lane"),"\u7684\u89c6\u89d2\u5206\u6790:"),a.a.createElement(c["a"],{code:"export function scheduleUpdateOnFiber(\n  fiber: Fiber,\n  lane: Lane,\n  eventTime: number,\n) {\n  if (lane === SyncLane) {\n    // legacy\u6216blocking\u6a21\u5f0f\n    if (\n      (executionContext & LegacyUnbatchedContext) !== NoContext &&\n      (executionContext & (RenderContext | CommitContext)) === NoContext\n    ) {\n      performSyncWorkOnRoot(root);\n    } else {\n      ensureRootIsScheduled(root, eventTime); // \u6ce8\u518c\u56de\u8c03\u4efb\u52a1\n      if (executionContext === NoContext) {\n        flushSyncCallbackQueue(); // \u53d6\u6d88schedule\u8c03\u5ea6 ,\u4e3b\u52a8\u5237\u65b0\u56de\u8c03\u961f\u5217,\n      }\n    }\n  } else {\n    // concurrent\u6a21\u5f0f\n    ensureRootIsScheduled(root, eventTime);\n  }\n}",lang:"js"}),a.a.createElement("p",null,"\u5f53",a.a.createElement("code",null,"lane === SyncLane"),"\u4e5f\u5c31\u662f legacy \u6216 blocking \u6a21\u5f0f\u4e2d, \u6ce8\u518c\u5b8c\u56de\u8c03\u4efb\u52a1\u4e4b\u540e(",a.a.createElement("code",null,"ensureRootIsScheduled(root, eventTime)"),"), \u5982\u679c\u6267\u884c\u4e0a\u4e0b\u6587\u4e3a\u7a7a, \u4f1a\u53d6\u6d88 schedule \u8c03\u5ea6, \u4e3b\u52a8\u5237\u65b0\u56de\u8c03\u961f\u5217",a.a.createElement("code",null,"flushSyncCallbackQueue()"),"."),a.a.createElement("p",null,"\u8fd9\u91cc\u5305\u542b\u4e86\u4e00\u4e2a\u70ed\u70b9\u95ee\u9898(",a.a.createElement("code",null,"setState\u5230\u5e95\u662f\u540c\u6b65\u8fd8\u662f\u5f02\u6b65"),")\u7684\u6807\u51c6\u7b54\u6848:"),a.a.createElement("ul",null,a.a.createElement("li",null,"\u5982\u679c\u903b\u8f91\u8fdb\u5165",a.a.createElement("code",null,"flushSyncCallbackQueue"),"(",a.a.createElement("code",null,"executionContext === NoContext"),"), \u5219\u4f1a\u4e3b\u52a8\u53d6\u6d88\u8c03\u5ea6, \u5e76\u5237\u65b0\u56de\u8c03, \u7acb\u5373\u8fdb\u5165",a.a.createElement("code",null,"fiber\u6811"),"\u6784\u9020\u8fc7\u7a0b. \u5f53\u6267\u884c",a.a.createElement("code",null,"setState"),"\u4e0b\u4e00\u884c\u4ee3\u7801\u65f6, ",a.a.createElement("code",null,"fiber\u6811"),"\u5df2\u7ecf\u91cd\u65b0\u6e32\u67d3\u4e86, \u6545",a.a.createElement("code",null,"setState"),"\u4f53\u73b0\u4e3a\u540c\u6b65."),a.a.createElement("li",null,"\u6b63\u5e38\u60c5\u51b5\u4e0b, \u4e0d\u4f1a\u53d6\u6d88",a.a.createElement("code",null,"schedule\u8c03\u5ea6"),". \u7531\u4e8e",a.a.createElement("code",null,"schedule\u8c03\u5ea6"),"\u662f\u901a\u8fc7",a.a.createElement("code",null,"MessageChannel"),"\u89e6\u53d1(\u5b8f\u4efb\u52a1), \u6545\u4f53\u73b0\u4e3a\u5f02\u6b65.")),a.a.createElement("h4",{id:"\u6e32\u67d3\u4f18\u5148\u7ea7renderlanes"},a.a.createElement(r["AnchorLink"],{to:"#\u6e32\u67d3\u4f18\u5148\u7ea7renderlanes","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),a.a.createElement("code",null,"\u6e32\u67d3"),"\u4f18\u5148\u7ea7(renderLanes)"),a.a.createElement("p",null,"\u8fd9\u662f\u4e00\u4e2a\u5168\u5c40\u6982\u5ff5, \u6bcf\u4e00\u6b21",a.a.createElement("code",null,"render"),"\u4e4b\u524d, \u9996\u5148\u8981\u786e\u5b9a\u672c\u6b21",a.a.createElement("code",null,"render"),"\u7684\u4f18\u5148\u7ea7. \u5177\u4f53\u5bf9\u5e94\u5230\u6e90\u7801\u5982\u4e0b:"),a.a.createElement(c["a"],{code:"// ...\u7701\u7565\u65e0\u5173\u4ee3\u7801\nfunction performSyncWorkOnRoot(root) {\n  let lanes;\n  let exitStatus;\n  // \u83b7\u53d6\u672c\u6b21`render`\u7684\u4f18\u5148\u7ea7\n  lanes = getNextLanes(root, lanes);\n  exitStatus = renderRootSync(root, lanes);\n}\n// ...\u7701\u7565\u65e0\u5173\u4ee3\u7801\nfunction performConcurrentWorkOnRoot(root) {\n  // \u83b7\u53d6\u672c\u6b21`render`\u7684\u4f18\u5148\u7ea7\n  let lanes = getNextLanes(\n    root,\n    root === workInProgressRoot ? workInProgressRootRenderLanes : NoLanes,\n  );\n  if (lanes === NoLanes) {\n    return null;\n  }\n  let exitStatus = renderRootConcurrent(root, lanes);\n}",lang:"js"}),a.a.createElement("p",null,"\u53ef\u4ee5\u770b\u5230, \u65e0\u8bba\u662f",a.a.createElement("code",null,"Legacy"),"\u8fd8\u662f",a.a.createElement("code",null,"Concurrent"),"\u6a21\u5f0f, \u5728\u6b63\u5f0f",a.a.createElement("code",null,"render"),"\u4e4b\u524d, \u90fd\u4f1a\u8c03\u7528",a.a.createElement("code",null,"getNextLanes"),"\u83b7\u53d6\u4e00\u4e2a\u4f18\u5148\u7ea7(",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberLane.js#L249-L303"},"\u6e90\u7801\u94fe\u63a5"),")."),a.a.createElement(c["a"],{code:"// ...\u7701\u7565\u90e8\u5206\u4ee3\u7801\nexport function getNextLanes(root: FiberRoot, wipLanes: Lanes): Lanes {\n  // 1. check\u662f\u5426\u6709\u7b49\u5f85\u4e2d\u7684lanes\n  const pendingLanes = root.pendingLanes;\n  if (pendingLanes === NoLanes) {\n    return_highestLanePriority = NoLanePriority;\n    return NoLanes;\n  }\n  let nextLanes = NoLanes;\n  let nextLanePriority = NoLanePriority;\n  const expiredLanes = root.expiredLanes;\n  const suspendedLanes = root.suspendedLanes;\n  const pingedLanes = root.pingedLanes;\n  // 2. check\u662f\u5426\u6709\u5df2\u8fc7\u671f\u7684lanes\n  if (expiredLanes !== NoLanes) {\n    nextLanes = expiredLanes;\n    nextLanePriority = return_highestLanePriority = SyncLanePriority;\n  } else {\n    const nonIdlePendingLanes = pendingLanes & NonIdleLanes;\n    if (nonIdlePendingLanes !== NoLanes) {\n      // \u975eIdle\u4efb\u52a1 ...\n    } else {\n      // Idle\u4efb\u52a1 ...\n    }\n  }\n  if (nextLanes === NoLanes) {\n    return NoLanes;\n  }\n  return nextLanes;\n}",lang:"js"}),a.a.createElement("p",null,a.a.createElement("code",null,"getNextLanes"),"\u4f1a\u6839\u636e",a.a.createElement("code",null,"fiberRoot"),"\u5bf9\u8c61\u4e0a\u7684\u5c5e\u6027(",a.a.createElement("code",null,"expiredLanes"),", ",a.a.createElement("code",null,"suspendedLanes"),", ",a.a.createElement("code",null,"pingedLanes"),"\u7b49), \u786e\u5b9a\u51fa\u5f53\u524d\u6700\u7d27\u6025\u7684",a.a.createElement("code",null,"lanes"),"."),a.a.createElement("p",null,"\u6b64\u5904\u8fd4\u56de\u7684",a.a.createElement("code",null,"lanes"),"\u4f1a\u4f5c\u4e3a\u5168\u5c40\u6e32\u67d3\u7684\u4f18\u5148\u7ea7, \u7528\u4e8e",a.a.createElement("code",null,"fiber\u6811\u6784\u9020\u8fc7\u7a0b"),"\u4e2d. \u9488\u5bf9",a.a.createElement("code",null,"fiber\u5bf9\u8c61"),"\u6216",a.a.createElement("code",null,"update\u5bf9\u8c61"),", \u53ea\u8981\u5b83\u4eec\u7684\u4f18\u5148\u7ea7(\u5982: ",a.a.createElement("code",null,"fiber.lanes"),"\u548c",a.a.createElement("code",null,"update.lane"),")\u6bd4",a.a.createElement("code",null,"\u6e32\u67d3\u4f18\u5148\u7ea7"),"\u4f4e, \u90fd\u5c06\u4f1a\u88ab\u5ffd\u7565."),a.a.createElement("h4",{id:"fiber\u4f18\u5148\u7ea7fiberlanes"},a.a.createElement(r["AnchorLink"],{to:"#fiber\u4f18\u5148\u7ea7fiberlanes","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),a.a.createElement("code",null,"fiber"),"\u4f18\u5148\u7ea7(fiber.lanes)"),a.a.createElement("p",null,"\u5728",a.a.createElement(r["Link"],{to:"./object-structure"},"React \u5e94\u7528\u4e2d\u7684\u9ad8\u9891\u5bf9\u8c61"),"\u4e00\u6587\u4e2d, \u4ecb\u7ecd\u8fc7",a.a.createElement("code",null,"fiber"),"\u5bf9\u8c61\u7684\u6570\u636e\u7ed3\u6784. \u5176\u4e2d\u6709 2 \u4e2a\u5c5e\u6027\u4e0e\u4f18\u5148\u7ea7\u76f8\u5173:"),a.a.createElement("ol",null,a.a.createElement("li",null,a.a.createElement("code",null,"fiber.lanes"),": \u4ee3\u8868\u672c\u8282\u70b9\u7684\u4f18\u5148\u7ea7"),a.a.createElement("li",null,a.a.createElement("code",null,"fiber.childLanes"),": \u4ee3\u8868\u5b50\u8282\u70b9\u7684\u4f18\u5148\u7ea7 \u4ece",a.a.createElement("code",null,"FiberNode"),"\u7684\u6784\u9020\u51fd\u6570\u4e2d\u53ef\u4ee5\u770b\u51fa, ",a.a.createElement("code",null,"fiber.lanes"),"\u548c",a.a.createElement("code",null,"fiber.childLanes"),"\u7684\u521d\u59cb\u503c\u90fd\u4e3a",a.a.createElement("code",null,"NoLanes"),", \u5728",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u8fc7\u7a0b\u4e2d, \u4f7f\u7528\u5168\u5c40\u7684\u6e32\u67d3\u4f18\u5148\u7ea7(",a.a.createElement("code",null,"renderLanes"),")\u548c",a.a.createElement("code",null,"fiber.lanes"),"\u5224\u65ad",a.a.createElement("code",null,"fiber"),"\u8282\u70b9\u662f\u5426\u66f4\u65b0(",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberBeginWork.old.js#L3121-L3296"},"\u6e90\u7801\u5730\u5740"),").",a.a.createElement("ul",null,a.a.createElement("li",null,"\u5982\u679c\u5168\u5c40\u7684\u6e32\u67d3\u4f18\u5148\u7ea7",a.a.createElement("code",null,"renderLanes"),"\u4e0d\u5305\u62ec",a.a.createElement("code",null,"fiber.lanes"),", \u8bc1\u660e\u8be5",a.a.createElement("code",null,"fiber"),"\u8282\u70b9\u6ca1\u6709\u66f4\u65b0, \u53ef\u4ee5\u590d\u7528."),a.a.createElement("li",null,"\u5982\u679c\u4e0d\u80fd\u590d\u7528, \u8fdb\u5165\u521b\u5efa\u9636\u6bb5.")))),a.a.createElement(c["a"],{code:"function beginWork(\n  current: Fiber | null,\n  workInProgress: Fiber,\n  renderLanes: Lanes,\n): Fiber | null {\n  const updateLanes = workInProgress.lanes;\n  if (current !== null) {\n    const oldProps = current.memoizedProps;\n    const newProps = workInProgress.pendingProps;\n    if (\n      oldProps !== newProps ||\n      hasLegacyContextChanged() ||\n      // Force a re-render if the implementation changed due to hot reload:\n      (__DEV__ ? workInProgress.type !== current.type : false)\n    ) {\n      didReceiveUpdate = true;\n    } else if (!includesSomeLane(renderLanes, updateLanes)) {\n      didReceiveUpdate = false;\n      // \u672c`fiber`\u8282\u70b9\u7684\u6ca1\u6709\u66f4\u65b0, \u53ef\u4ee5\u590d\u7528, \u8fdb\u5165bailout\u903b\u8f91\n      return bailoutOnAlreadyFinishedWork(current, workInProgress, renderLanes);\n    }\n  }\n  // \u4e0d\u80fd\u590d\u7528, \u521b\u5efa\u65b0\u7684fiber\u8282\u70b9\n  workInProgress.lanes = NoLanes; // \u91cd\u7f6e\u4f18\u5148\u7ea7\u4e3a NoLanes\n  switch (workInProgress.tag) {\n    case ClassComponent: {\n      const Component = workInProgress.type;\n      const unresolvedProps = workInProgress.pendingProps;\n      const resolvedProps =\n        workInProgress.elementType === Component\n          ? unresolvedProps\n          : resolveDefaultProps(Component, unresolvedProps);\n\n      return updateClassComponent(\n        current,\n        workInProgress,\n        Component,\n        resolvedProps,\n        // \u6b63\u5e38\u60c5\u51b5\u4e0b\u6e32\u67d3\u4f18\u5148\u7ea7\u4f1a\u88ab\u7528\u4e8efiber\u6811\u7684\u6784\u9020\u8fc7\u7a0b\n        renderLanes,\n      );\n    }\n  }\n}",lang:"js"}),a.a.createElement("h3",{id:"\u6808\u5e27\u7ba1\u7406"},a.a.createElement(r["AnchorLink"],{to:"#\u6808\u5e27\u7ba1\u7406","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u6808\u5e27\u7ba1\u7406"),a.a.createElement("p",null,"\u5728",a.a.createElement("code",null,"React"),"\u6e90\u7801\u4e2d, \u6bcf\u4e00\u6b21\u6267\u884c",a.a.createElement("code",null,"fiber\u6811"),"\u6784\u9020(\u4e5f\u5c31\u662f\u8c03\u7528",a.a.createElement("code",null,"performSyncWorkOnRoot"),"\u6216\u8005",a.a.createElement("code",null,"performConcurrentWorkOnRoot"),"\u51fd\u6570)\u7684\u8fc7\u7a0b, \u90fd\u9700\u8981\u4e00\u4e9b\u5168\u5c40\u53d8\u91cf\u6765\u4fdd\u5b58\u72b6\u6001. \u5728\u4e0a\u6587\u4e2d\u5df2\u7ecf\u4ecb\u7ecd\u6700\u6838\u5fc3\u7684\u5168\u5c40\u53d8\u91cf."),a.a.createElement("p",null,"\u5982\u679c\u4ece\u5355\u4e2a\u53d8\u91cf\u6765\u770b, \u5b83\u4eec\u5c31\u662f\u4e00\u4e2a\u4e2a\u7684\u5168\u5c40\u53d8\u91cf. \u5982\u679c\u5c06\u8fd9\u4e9b\u5168\u5c40\u53d8\u91cf\u7ec4\u5408\u8d77\u6765, \u5b83\u4eec\u4ee3\u8868\u4e86\u5f53\u524d",a.a.createElement("code",null,"fiber\u6811"),"\u6784\u9020\u7684\u6d3b\u52a8\u8bb0\u5f55. \u901a\u8fc7\u8fd9\u4e00\u7ec4\u5168\u5c40\u53d8\u91cf, \u53ef\u4ee5\u8fd8\u539f",a.a.createElement("code",null,"fiber\u6811"),"\u6784\u9020\u8fc7\u7a0b(\u6bd4\u5982\u65f6\u95f4\u5207\u7247\u7684\u5b9e\u73b0\u8fc7\u7a0b(\u53c2\u8003",a.a.createElement(r["AnchorLink"],{to:"./scheduler#%E5%86%85%E6%A0%B8"},"React \u8c03\u5ea6\u539f\u7406"),"), ",a.a.createElement("code",null,"fiber\u6811"),"\u6784\u9020\u8fc7\u7a0b\u88ab\u6253\u65ad\u4e4b\u540e\u9700\u8981\u8fd8\u539f\u8fdb\u5ea6, \u5168\u9760\u8fd9\u4e00\u7ec4\u5168\u5c40\u53d8\u91cf). \u6240\u4ee5\u6bcf\u6b21",a.a.createElement("code",null,"fiber\u6811"),"\u6784\u9020\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u8fc7\u7a0b, \u9700\u8981",a.a.createElement("code",null,"\u72ec\u7acb\u7684"),"\u4e00\u7ec4\u5168\u5c40\u53d8\u91cf, \u5728",a.a.createElement("code",null,"React"),"\u5185\u90e8\u628a\u8fd9\u4e00\u4e2a\u72ec\u7acb\u7684\u8fc7\u7a0b\u5c01\u88c5\u4e3a\u4e00\u4e2a\u6808\u5e27",a.a.createElement("code",null,"stack"),"(\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u6bcf\u6b21\u6784\u9020\u90fd\u9700\u8981\u72ec\u7acb\u7684\u7a7a\u95f4. \u5bf9\u4e8e",a.a.createElement("code",null,"\u6808\u5e27"),"\u7684\u6df1\u5165\u7406\u89e3, \u8bf7\u8bfb\u8005\u81ea\u884c\u53c2\u8003\u5176\u4ed6\u8d44\u6599)."),a.a.createElement("p",null,"\u6240\u4ee5\u5728\u8fdb\u884c",a.a.createElement("code",null,"fiber\u6811"),"\u6784\u9020\u4e4b\u524d, \u5982\u679c\u4e0d\u9700\u8981\u6062\u590d\u4e0a\u4e00\u6b21\u6784\u9020\u8fdb\u5ea6, \u90fd\u4f1a\u5237\u65b0\u6808\u5e27(\u6e90\u7801\u5728",a.a.createElement(r["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L1301-L1337"},"prepareFreshStack \u51fd\u6570"),")"),a.a.createElement(c["a"],{code:"function renderRootConcurrent(root: FiberRoot, lanes: Lanes) {\n  const prevExecutionContext = executionContext;\n  executionContext |= RenderContext;\n  const prevDispatcher = pushDispatcher();\n  // \u5982\u679cfiberRoot\u53d8\u52a8, \u6216\u8005update.lane\u53d8\u52a8, \u90fd\u4f1a\u5237\u65b0\u6808\u5e27, \u4e22\u5f03\u4e0a\u4e00\u6b21\u6e32\u67d3\u8fdb\u5ea6\n  if (workInProgressRoot !== root || workInProgressRootRenderLanes !== lanes) {\n    resetRenderTimer();\n    // \u5237\u65b0\u6808\u5e27\n    prepareFreshStack(root, lanes);\n    startWorkOnPendingInteractions(root, lanes);\n  }\n}\n\n/**\n\u5237\u65b0\u6808\u5e27: \u91cd\u7f6e FiberRoot\u4e0a\u7684\u5168\u5c40\u5c5e\u6027 \u548c `fiber\u6811\u6784\u9020`\u5faa\u73af\u8fc7\u7a0b\u4e2d\u7684\u5168\u5c40\u53d8\u91cf\n*/\nfunction prepareFreshStack(root: FiberRoot, lanes: Lanes) {\n  // \u91cd\u7f6eFiberRoot\u5bf9\u8c61\u4e0a\u7684\u5c5e\u6027\n  root.finishedWork = null;\n  root.finishedLanes = NoLanes;\n  const timeoutHandle = root.timeoutHandle;\n  if (timeoutHandle !== noTimeout) {\n    root.timeoutHandle = noTimeout;\n    cancelTimeout(timeoutHandle);\n  }\n  if (workInProgress !== null) {\n    let interruptedWork = workInProgress.return;\n    while (interruptedWork !== null) {\n      unwindInterruptedWork(interruptedWork);\n      interruptedWork = interruptedWork.return;\n    }\n  }\n  // \u91cd\u7f6e\u5168\u5c40\u53d8\u91cf\n  workInProgressRoot = root;\n  workInProgress = createWorkInProgress(root.current, null); // \u7ed9HostRootFiber\u5bf9\u8c61\u521b\u5efa\u4e00\u4e2aalternate, \u5e76\u5c06\u5176\u8bbe\u7f6e\u6210\u5168\u5c40 workInProgress\n  workInProgressRootRenderLanes = subtreeRenderLanes = workInProgressRootIncludedLanes = lanes;\n  workInProgressRootExitStatus = RootIncomplete;\n  workInProgressRootFatalError = null;\n  workInProgressRootSkippedLanes = NoLanes;\n  workInProgressRootUpdatedLanes = NoLanes;\n  workInProgressRootPingedLanes = NoLanes;\n}",lang:"js"}),a.a.createElement("p",null,"\u6ce8\u610f\u5176\u4e2d\u7684",a.a.createElement("code",null,"createWorkInProgress(root.current, null)"),", \u5176\u53c2\u6570",a.a.createElement("code",null,"root.current"),"\u5373",a.a.createElement("code",null,"HostRootFiber"),", \u4f5c\u7528\u662f\u7ed9",a.a.createElement("code",null,"HostRootFiber"),"\u521b\u5efa\u4e00\u4e2a",a.a.createElement("code",null,"alternate"),"\u526f\u672c.",a.a.createElement("code",null,"workInProgress"),"\u6307\u9488\u6307\u5411\u8fd9\u4e2a\u526f\u672c(\u5373",a.a.createElement("code",null,"workInProgress = HostRootFiber.alternate"),"), \u5728\u4e0a\u6587",a.a.createElement("code",null,"double buffering"),"\u4e2d\u5206\u6790\u8fc7, ",a.a.createElement("code",null,"HostRootFiber.alternate"),"\u662f",a.a.createElement("code",null,"\u6b63\u5728\u6784\u9020\u7684fiber\u6811"),"\u7684\u6839\u8282\u70b9."),a.a.createElement("h2",{id:"\u603b\u7ed3"},a.a.createElement(r["AnchorLink"],{to:"#\u603b\u7ed3","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u603b\u7ed3"),a.a.createElement("p",null,"\u672c\u8282\u662f",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u7684\u51c6\u5907\u7bc7, \u9996\u5148\u5728\u5b8f\u89c2\u4e0a\u4ece\u4e0d\u540c\u7684\u89c6\u89d2(",a.a.createElement("code",null,"\u4efb\u52a1\u8c03\u5ea6\u5faa\u73af"),", ",a.a.createElement("code",null,"fiber\u6811\u6784\u9020\u5faa\u73af"),")\u4ecb\u7ecd\u4e86",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u5728",a.a.createElement("code",null,"React"),"\u4f53\u7cfb\u4e2d\u6240\u5904\u7684\u4f4d\u7f6e, \u7136\u540e\u6df1\u5165",a.a.createElement("code",null,"react-reconciler"),"\u5305\u5206\u6790",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u8fc7\u7a0b\u4e2d\u9700\u8981\u4f7f\u7528\u5230\u7684\u5168\u5c40\u53d8\u91cf, \u5e76\u89e3\u8bfb\u4e86",a.a.createElement("code",null,"\u53cc\u7f13\u51b2\u6280\u672f"),"\u548c",a.a.createElement("code",null,"\u4f18\u5148\u7ea7(\u8f66\u9053\u6a21\u578b)"),"\u7684\u4f7f\u7528, \u6700\u540e\u89e3\u91ca",a.a.createElement("code",null,"\u6808\u5e27\u7ba1\u7406"),"\u7684\u5b9e\u73b0\u7ec6\u8282. \u6709\u4e86\u8fd9\u4e9b\u57fa\u7840\u77e5\u8bc6, ",a.a.createElement("code",null,"fiber\u6811\u6784\u9020"),"\u7684\u5177\u4f53\u5b9e\u73b0\u8fc7\u7a0b\u4f1a\u66f4\u52a0\u7b80\u5355\u6e05\u6670.")))}));n["default"]=e=>{var n=a.a.useContext(r["context"]),t=n.demos;return a.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&r["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),a.a.createElement(o,{demos:t})}},wOdG:function(e,n,t){e.exports=t.p+"static/reactfiberworkloop.59263ed5.png"},xeiz:function(e,n,t){e.exports=t.p+"static/code2dom.91f1b68b.png"}}]);