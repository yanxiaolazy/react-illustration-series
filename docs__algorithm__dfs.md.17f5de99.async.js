(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{DROX:function(e,n,t){e.exports=t.p+"static/dfs-reactelement.e386627d.png"},rGcG:function(e,n,t){e.exports=t.p+"static/dfs-fibertree.0d88767b.png"},t3BQ:function(e,n,t){"use strict";t.r(n);var l=t("q1tI"),a=t.n(l),c=t("dEAq"),r=t("H1Ra"),o=a.a.memo((e=>{e.demos;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"markdown"},a.a.createElement("h1",{id:"react-\u7b97\u6cd5\u4e4b\u6df1\u5ea6\u4f18\u5148\u904d\u5386"},a.a.createElement(c["AnchorLink"],{to:"#react-\u7b97\u6cd5\u4e4b\u6df1\u5ea6\u4f18\u5148\u904d\u5386","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"React \u7b97\u6cd5\u4e4b\u6df1\u5ea6\u4f18\u5148\u904d\u5386"),a.a.createElement("p",null,"\u5bf9\u4e8e\u6811\u6216\u56fe\u7ed3\u6784\u7684\u641c\u7d22(\u6216\u904d\u5386)\u6765\u8bb2, \u5206\u4e3a\u6df1\u5ea6\u4f18\u5148(DFS)\u548c\u5e7f\u5ea6\u4f18\u5148(BFS)."),a.a.createElement("h2",{id:"\u6982\u5ff5"},a.a.createElement(c["AnchorLink"],{to:"#\u6982\u5ff5","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u6982\u5ff5"),a.a.createElement("p",null,"\u6df1\u5ea6\u4f18\u5148\u904d\u5386: DFS(\u82f1\u8bed:Depth-First-Search,DFS)\u662f\u4e00\u79cd\u7528\u4e8e\u904d\u5386\u6216\u641c\u7d22\u6811\u6216\u56fe\u7684\u7b97\u6cd5."),a.a.createElement("p",null,"\u6765\u81ea wiki \u4e0a\u7684\u89e3\u91ca(\u66f4\u6743\u5a01): \u5f53",a.a.createElement("code",null,"\u8282\u70b9v"),"\u7684\u6240\u5728\u8fb9\u90fd\u5df1\u88ab\u63a2\u5bfb\u8fc7, \u641c\u7d22\u5c06\u56de\u6eaf\u5230\u53d1\u73b0",a.a.createElement("code",null,"\u8282\u70b9v"),"\u7684\u90a3\u6761\u8fb9\u7684\u8d77\u59cb\u8282\u70b9. \u8fd9\u4e00\u8fc7\u7a0b\u4e00\u76f4\u8fdb\u884c\u5230\u5df2\u53d1\u73b0\u4ece\u6e90\u8282\u70b9\u53ef\u8fbe\u7684\u6240\u6709\u8282\u70b9\u4e3a\u6b62. \u5982\u679c\u8fd8\u5b58\u5728\u672a\u88ab\u53d1\u73b0\u7684\u8282\u70b9, \u5219\u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u4f5c\u4e3a\u6e90\u8282\u70b9\u5e76\u91cd\u590d\u4ee5\u4e0a\u8fc7\u7a0b, \u6574\u4e2a\u8fdb\u7a0b\u53cd\u590d\u8fdb\u884c\u76f4\u5230\u6240\u6709\u8282\u70b9\u90fd\u88ab\u8bbf\u95ee\u4e3a\u6b62."),a.a.createElement("h2",{id:"\u5b9e\u73b0\u65b9\u5f0f"},a.a.createElement(c["AnchorLink"],{to:"#\u5b9e\u73b0\u65b9\u5f0f","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u5b9e\u73b0\u65b9\u5f0f"),a.a.createElement("p",null,"DFS \u7684\u4e3b\u6d41\u5b9e\u73b0\u65b9\u5f0f\u6709 2 \u79cd."),a.a.createElement("ol",null,a.a.createElement("li",null,"\u9012\u5f52(\u7b80\u5355\u7c97\u66b4)"),a.a.createElement("li",null,"\u5229\u7528",a.a.createElement("code",null,"\u6808"),"\u5b58\u50a8\u904d\u5386\u8def\u5f84")),a.a.createElement(r["a"],{code:"function Node() {\n  this.name = '';\n  this.children = [];\n}\n\nfunction dfs(node) {\n  console.log('\u63a2\u5bfb\u9636\u6bb5: ', node.name);\n  node.children.forEach(child => {\n    dfs(child);\n  });\n  console.log('\u56de\u6eaf\u9636\u6bb5: ', node.name);\n}",lang:"js"}),a.a.createElement("ol",{start:2},a.a.createElement("li",null,"\u4f7f\u7528\u6808")),a.a.createElement(r["a"],{code:"function Node() {\n  this.name = '';\n  this.children = [];\n\n  // \u56e0\u4e3a\u8981\u5206\u8fa8\u63a2\u5bfb\u9636\u6bb5\u548c\u56de\u6eaf\u9636\u6bb5, \u6240\u4ee5\u5fc5\u987b\u8981\u4e00\u4e2a\u5c5e\u6027\u6765\u8bb0\u5f55\u662f\u5426\u5df2\u7ecf\u8bbf\u95ee\u8fc7\u8be5\u8282\u70b9\n  // \u5982\u679c\u4e0d\u6253\u5370\u63a2\u5bfb\u548c\u56de\u6eaf, \u5c31\u4e0d\u9700\u8981\u6b64\u5c5e\u6027\n  this.visited = false;\n}\n\nfunction dfs(node) {\n  const stack = [];\n  stack.push(node);\n  // \u6808\u9876\u5143\u7d20\u8fd8\u5b58\u5728, \u5c31\u7ee7\u7eed\u5faa\u73af\n  while ((node = stack[stack.length - 1])) {\n    if (node.visited) {\n      console.log('\u56de\u6eaf\u9636\u6bb5: ', node.name);\n      // \u56de\u6eaf\u5b8c\u6210, \u5f39\u51fa\u8be5\u5143\u7d20\n      stack.pop();\n    } else {\n      console.log('\u63a2\u5bfb\u9636\u6bb5: ', node.name);\n      node.visited = true;\n      // \u5229\u7528\u6808\u7684\u5148\u8fdb\u540e\u51fa\u7684\u7279\u6027, \u5012\u5e8f\u5c06\u8282\u70b9\u9001\u5165\u6808\u4e2d\n      for (let i = node.children.length - 1; i >= 0; i--) {\n        stack.push(node.children[i]);\n      }\n    }\n  }\n}",lang:"js"}),a.a.createElement("h2",{id:"react-\u5f53\u4e2d\u7684\u4f7f\u7528\u573a\u666f"},a.a.createElement(c["AnchorLink"],{to:"#react-\u5f53\u4e2d\u7684\u4f7f\u7528\u573a\u666f","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"React \u5f53\u4e2d\u7684\u4f7f\u7528\u573a\u666f"),a.a.createElement("p",null,"\u6df1\u5ea6\u4f18\u5148\u904d\u5386\u5728",a.a.createElement("code",null,"react"),"\u5f53\u4e2d\u7684\u4f7f\u7528\u975e\u5e38\u5178\u578b, \u6700\u4e3b\u8981\u7684\u4f7f\u7528\u65f6\u5728",a.a.createElement("code",null,"ReactElement"),"\u548c",a.a.createElement("code",null,"fiber"),"\u6811\u7684\u6784\u9020\u8fc7\u7a0b. \u5176\u6b21\u662f\u5728\u4f7f\u7528",a.a.createElement("code",null,"context"),"\u65f6, \u9700\u8981\u6df1\u5ea6\u4f18\u5148\u5730\u67e5\u627e\u6d88\u8d39",a.a.createElement("code",null,"context"),"\u7684\u8282\u70b9."),a.a.createElement("h3",{id:"reactelement-\u6811\u7684\u6784\u9020"},a.a.createElement(c["AnchorLink"],{to:"#reactelement-\u6811\u7684\u6784\u9020","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),'ReactElement "\u6811"\u7684\u6784\u9020'),a.a.createElement("p",null,a.a.createElement("code",null,"ReactElement"),"\u4e0d\u80fd\u7b97\u662f\u4e25\u683c\u7684\u6811\u7ed3\u6784, \u4e3a\u4e86\u65b9\u4fbf\u8868\u8ff0, \u540e\u6587\u90fd\u79f0\u4e4b\u4e3a\u6811."),a.a.createElement("p",null,"\u5728",a.a.createElement("code",null,"react-reconciler"),"\u5305\u4e2d, ",a.a.createElement("code",null,"ReactElement"),"\u7684\u6784\u9020\u8fc7\u7a0b\u5b9e\u9645\u4e0a\u662f\u5d4c\u5957\u5728",a.a.createElement("code",null,"fiber\u6811\u6784\u9020\u5faa\u73af"),"\u8fc7\u7a0b\u4e2d\u7684, \u4e0e",a.a.createElement("code",null,"fiber"),"\u6811\u7684\u6784\u9020\u662f\u76f8\u4e92\u4ea4\u66ff\u8fdb\u884c\u7684(\u5728",a.a.createElement("code",null,"fiber \u6811\u6784\u5efa"),"\u7ae0\u8282\u4e2d\u8be6\u7ec6\u89e3\u8bfb, \u672c\u8282\u53ea\u4ecb\u7ecd\u6df1\u5ea6\u4f18\u5148\u904d\u5386\u7684\u4f7f\u7528\u573a\u666f)."),a.a.createElement("p",null,a.a.createElement("code",null,"ReactElement"),"\u6811\u7684\u6784\u9020, \u5b9e\u9645\u4e0a\u5c31\u662f\u5404\u7ea7\u7ec4\u4ef6",a.a.createElement("code",null,"render"),"\u4e4b\u540e\u7684\u603b\u548c. \u6574\u4e2a\u8fc7\u7a0b\u4f53\u73b0\u5728",a.a.createElement("code",null,"reconciler"),"\u5de5\u4f5c\u5faa\u73af\u4e4b\u4e2d."),a.a.createElement("p",null,"\u6e90\u7801\u4f4d\u4e8e",a.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberWorkLoop.old.js#L1558"},a.a.createElement("code",null,"ReactFiberWorkLoop.js")),"\u4e2d, \u6b64\u5904\u4e3a\u4e86\u7b80\u660e, \u5df2\u7ecf\u5c06\u6e90\u7801\u4e2d\u4e0e dfs \u65e0\u5173\u7684\u65c1\u652f\u903b\u8f91\u53bb\u6389."),a.a.createElement(r["a"],{code:"function workLoopSync() {\n  // 1. \u6700\u5916\u5c42\u5faa\u73af, \u4fdd\u8bc1\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u80fd\u904d\u5386, \u4e0d\u4f1a\u9057\u6f0f\n  while (workInProgress !== null) {\n    performUnitOfWork(workInProgress);\n  }\n}\n\nfunction performUnitOfWork(unitOfWork: Fiber): void {\n  const current = unitOfWork.alternate;\n  let next;\n  // 2. beginWork\u662f\u5411\u4e0b\u63a2\u5bfb\u9636\u6bb5\n  next = beginWork(current, unitOfWork, subtreeRenderLanes);\n  if (next === null) {\n    // 3. completeUnitOfWork \u662f\u56de\u6eaf\u9636\u6bb5\n    completeUnitOfWork(unitOfWork);\n  } else {\n    workInProgress = next;\n  }\n}\n\nfunction completeUnitOfWork(unitOfWork: Fiber): void {\n  let completedWork = unitOfWork;\n  do {\n    const current = completedWork.alternate;\n    const returnFiber = completedWork.return;\n    let next;\n    // 3.1 \u56de\u6eaf\u5e76\u5904\u7406\u8282\u70b9\n    next = completeWork(current, completedWork, subtreeRenderLanes);\n    if (next !== null) {\n      // \u5224\u65ad\u5728\u5904\u7406\u8282\u70b9\u7684\u8fc7\u7a0b\u4e2d, \u662f\u5426\u6d3e\u751f\u51fa\u65b0\u7684\u8282\u70b9\n      workInProgress = next;\n      return;\n    }\n    const siblingFiber = completedWork.sibling;\n    // 3.2 \u5224\u65ad\u662f\u5426\u6709\u65c1\u652f\n    if (siblingFiber !== null) {\n      workInProgress = siblingFiber;\n      return;\n    }\n    // 3.3 \u6ca1\u6709\u65c1\u652f \u7ee7\u7eed\u56de\u6eaf\n    completedWork = returnFiber;\n    workInProgress = completedWork;\n  } while (completedWork !== null);\n}",lang:"js"}),a.a.createElement("p",null,"\u4ee5\u4e0a\u6e90\u7801\u672c\u8d28\u4e0a\u662f\u91c7\u7528\u9012\u5f52\u7684\u65b9\u5f0f\u8fdb\u884c dfs, \u5047\u8bbe\u6709\u4ee5\u4e0b\u7ec4\u4ef6\u7ed3\u6784:"),a.a.createElement(r["a"],{code:'class App extends React.Component {\n  render() {\n    return (\n      <div className="app">\n        <header>header</header>\n        <Content />\n        <footer>footer</footer>\n      </div>\n    );\n  }\n}\n\nclass Content extends React.Component {\n  render() {\n    return (\n      <React.Fragment>\n        <p>1</p>\n        <p>2</p>\n        <p>3</p>\n      </React.Fragment>\n    );\n  }\n}\n\nexport default App;',lang:"js"}),a.a.createElement("p",null,"\u5219\u53ef\u4ee5\u7ed8\u5236\u51fa\u904d\u5386\u8def\u5f84\u5982\u4e0b:"),a.a.createElement("img",{src:t("DROX"),width:500}),a.a.createElement("p",null,"\u6ce8\u610f:"),a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement("code",null,"ReactElement"),"\u6811\u662f\u5728\u5927\u5faa\u73af\u4e2d\u7684",a.a.createElement("code",null,"beginWork"),'\u9636\u6bb5"\u9010\u7ea7"\u751f\u6210\u7684.'),a.a.createElement("li",null,'"\u9010\u7ea7"\u4e2d\u7684\u6bcf\u4e00\u7ea7\u662f\u6307\u4e00\u4e2a',a.a.createElement("code",null,"class"),"\u6216",a.a.createElement("code",null,"function"),"\u7c7b\u578b\u7684\u7ec4\u4ef6, \u6bcf\u8c03\u7528\u4e00\u6b21",a.a.createElement("code",null,"render"),"\u6216\u6267\u884c\u4e00\u6b21",a.a.createElement("code",null,"function"),"\u8c03\u7528, \u5c31\u4f1a\u751f\u6210\u4e00\u6279",a.a.createElement("code",null,"ReactElement"),"\u8282\u70b9."),a.a.createElement("li",null,a.a.createElement("code",null,"ReactElement"),"\u6811\u7684\u6784\u9020, \u5b9e\u9645\u4e0a\u5c31\u662f\u5404\u7ea7\u7ec4\u4ef6",a.a.createElement("code",null,"render"),"\u4e4b\u540e\u7684\u603b\u548c.")),a.a.createElement("h3",{id:"fiber-\u6811\u7684\u6784\u9020"},a.a.createElement(c["AnchorLink"],{to:"#fiber-\u6811\u7684\u6784\u9020","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"fiber \u6811\u7684\u6784\u9020"),a.a.createElement("p",null,"\u5728",a.a.createElement("code",null,"ReactElement"),"\u7684\u6784\u9020\u8fc7\u7a0b\u4e2d, \u540c\u65f6\u4f34\u968f\u7740",a.a.createElement("code",null,"fiber"),"\u6811\u7684\u6784\u9020, ",a.a.createElement("code",null,"fiber"),"\u6811\u540c\u6837\u4e5f\u662f\u5728",a.a.createElement("code",null,"beginWork"),"\u9636\u6bb5\u751f\u6210\u7684."),a.a.createElement("p",null,"\u7ed8\u5236\u51fa\u904d\u5386\u8def\u5f84\u5982\u4e0b:"),a.a.createElement("p",null,a.a.createElement("img",{src:t("rGcG"),alt:""})),a.a.createElement("h3",{id:"\u67e5\u627e-context-\u7684\u6d88\u8d39\u8282\u70b9"},a.a.createElement(c["AnchorLink"],{to:"#\u67e5\u627e-context-\u7684\u6d88\u8d39\u8282\u70b9","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u67e5\u627e context \u7684\u6d88\u8d39\u8282\u70b9"),a.a.createElement("p",null,"\u5f53",a.a.createElement("code",null,"context"),"\u6539\u53d8\u4e4b\u540e, \u9700\u8981\u627e\u51fa\u4f9d\u8d56\u8be5",a.a.createElement("code",null,"context"),"\u7684\u6240\u6709\u5b50\u8282\u70b9(\u8be6\u7ec6\u5206\u6790\u4f1a\u5728",a.a.createElement("code",null,"context\u539f\u7406"),"\u7ae0\u8282\u6df1\u5165\u89e3\u8bfb), \u8fd9\u91cc\u540c\u6837\u4e5f\u662f\u4e00\u4e2a",a.a.createElement("code",null,"DFS"),", \u5177\u4f53\u6e90\u7801\u5728",a.a.createElement(c["Link"],{to:"https://github.com/facebook/react/blob/v17.0.2/packages/react-reconciler/src/ReactFiberNewContext.old.js#L182-L295"},"ReactFiberNewContext.js"),"."),a.a.createElement("p",null,"\u5c06\u5176\u4e3b\u5e72\u903b\u8f91\u5265\u79bb\u51fa\u6765, \u53ef\u4ee5\u6e05\u6670\u7684\u770b\u51fa\u91c7\u7528\u5faa\u73af\u9012\u5f52\u7684\u65b9\u5f0f\u8fdb\u884c\u904d\u5386:"),a.a.createElement(r["a"],{code:"export function propagateContextChange(\n  workInProgress: Fiber,\n  context: ReactContext<mixed>,\n  changedBits: number,\n  renderLanes: Lanes,\n): void {\n  let fiber = workInProgress.child;\n  while (fiber !== null) {\n    let nextFiber;\n    // Visit this fiber.\n    const list = fiber.dependencies;\n    if (list !== null) {\n      // \u5339\u914dcontext\u7b49\u903b\u8f91, \u548cdfs\u65e0\u5173, \u6b64\u5904\u53ef\u4ee5\u6682\u65f6\u5ffd\u7565\n      // ...\n    } else {\n      // \u5411\u4e0b\u63a2\u5bfb\n      nextFiber = fiber.child;\n    }\n    fiber = nextFiber;\n  }\n}",lang:"js"}),a.a.createElement("h2",{id:"\u603b\u7ed3"},a.a.createElement(c["AnchorLink"],{to:"#\u603b\u7ed3","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u603b\u7ed3"),a.a.createElement("p",null,"\u7531\u4e8e",a.a.createElement("code",null,"react"),"\u5185\u90e8\u4f7f\u7528\u4e86",a.a.createElement("code",null,"ReactElement"),"\u548c",a.a.createElement("code",null,"fiber"),"\u4e24\u5927\u6811\u5f62\u7ed3\u6784, \u6240\u4ee5\u6709\u4e0d\u5c11\u5173\u4e8e\u8282\u70b9\u8bbf\u95ee\u7684\u903b\u8f91."),a.a.createElement("p",null,"\u672c\u8282\u4e3b\u8981\u4ecb\u7ecd\u4e86",a.a.createElement("code",null,"DFS"),"\u7684\u6982\u5ff5\u548c\u5b83\u5728",a.a.createElement("code",null,"react"),"\u6e90\u7801\u4e2d\u7684\u4f7f\u7528\u60c5\u51b5. \u5176\u4e2d",a.a.createElement("code",null,"fiber"),"\u6811\u7684",a.a.createElement("code",null,"DFS"),"\u904d\u5386, \u6d89\u53ca\u5230\u7684\u4ee3\u7801\u591a, \u5206\u5e03\u5e7f, \u6db5\u76d6\u4e86",a.a.createElement("code",null,"reconciler"),"\u9636\u6bb5\u7684\u5927\u90e8\u5206\u5de5\u4f5c, \u662f",a.a.createElement("code",null,"reconciler"),"\u9636\u6bb5\u5de5\u4f5c\u5faa\u73af\u7684\u6838\u5fc3\u6d41\u7a0b."),a.a.createElement("p",null,"\u9664\u4e86",a.a.createElement("code",null,"DFS"),"\u4e4b\u5916, \u6e90\u7801\u4e2d\u8fd8\u6709\u5f88\u591a\u903b\u8f91\u90fd\u662f\u67e5\u627e\u6811\u4e2d\u7684\u8282\u70b9(\u5982: \u5411\u4e0a\u67e5\u627e\u7236\u8282\u70b9\u7b49). \u5bf9\u6811\u5f62\u7ed3\u6784\u7684\u904d\u5386\u5728\u6e90\u7801\u4e2d\u7684\u6bd4\u4f8b\u5f88\u9ad8, \u4e86\u89e3\u8fd9\u4e9b\u7b97\u6cd5\u6280\u5de7\u80fd\u591f\u66f4\u597d\u7684\u7406\u89e3",a.a.createElement("code",null,"react"),"\u6e90\u7801."),a.a.createElement("h2",{id:"\u53c2\u8003\u8d44\u6599"},a.a.createElement(c["AnchorLink"],{to:"#\u53c2\u8003\u8d44\u6599","aria-hidden":"true",tabIndex:-1},a.a.createElement("span",{className:"icon icon-link"})),"\u53c2\u8003\u8d44\u6599"),a.a.createElement("p",null,a.a.createElement(c["Link"],{to:"https://zh.wikipedia.org/wiki/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2"},"\u6df1\u5ea6\u4f18\u5148\u641c\u7d22"))))}));n["default"]=e=>{var n=a.a.useContext(c["context"]),t=n.demos;return a.a.useEffect((()=>{var n;null!==e&&void 0!==e&&null!==(n=e.location)&&void 0!==n&&n.hash&&c["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),a.a.createElement(o,{demos:t})}}}]);